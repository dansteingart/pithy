"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var _regenerator=require("babel-runtime/regenerator"),_regenerator2=_interopRequireDefault(_regenerator),_asyncToGenerator2=require("babel-runtime/helpers/asyncToGenerator"),_asyncToGenerator3=_interopRequireDefault(_asyncToGenerator2),handleEEXIST=function(){var e=(0,_asyncToGenerator3["default"])(_regenerator2["default"].mark(function r(e,t,n,a){var u;return _regenerator2["default"].wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,_fsPromise2["default"].readlink(t);case 2:if(u=r.sent,e!==u){r.next=5;break}throw new Error("Not a link");case 5:return r.next=7,_fsPromise2["default"].unlink(t);case 7:return r.next=9,forceSymlink(e,t,n);case 9:case"end":return r.stop()}},r,this)}));return function(r,t,n,a){return e.apply(this,arguments)}}(),handleENOENT=function(){var e=(0,_asyncToGenerator3["default"])(_regenerator2["default"].mark(function r(e,t,n,a){return _regenerator2["default"].wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,(0,_mkdirpThen2["default"])(_path2["default"].dirname(t));case 2:return r.next=4,forceSymlink(e,t,n);case 4:case"end":return r.stop()}},r,this)}));return function(r,t,n,a){return e.apply(this,arguments)}}(),forceSymlink=function(){var e=(0,_asyncToGenerator3["default"])(_regenerator2["default"].mark(function r(e,t,n,a){return _regenerator2["default"].wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return n="string"==typeof n?n:null,r.prev=1,r.next=4,_fsPromise2["default"].symlink(e,t,n);case 4:r.next=19;break;case 6:if(r.prev=6,r.t0=r["catch"](1),"ENOENT"!==r.t0.code){r.next=14;break}return r.next=11,handleENOENT(e,t,n);case 11:return r.abrupt("return",r.sent);case 14:if("EEXIST"!==r.t0.code){r.next=18;break}return r.next=17,handleEEXIST(e,t,n);case 17:return r.abrupt("return",r.sent);case 18:throw r.t0;case 19:case"end":return r.stop()}},r,this,[[1,6]])}));return function(r,t,n,a){return e.apply(this,arguments)}}(),_fsPromise=require("fs-promise"),_fsPromise2=_interopRequireDefault(_fsPromise),_path=require("path"),_path2=_interopRequireDefault(_path),_mkdirpThen=require("mkdirp-then"),_mkdirpThen2=_interopRequireDefault(_mkdirpThen);exports["default"]=forceSymlink;