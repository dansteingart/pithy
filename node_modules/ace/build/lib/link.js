"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}function getSymlinks(e,r){var n=[e,_path2["default"].join(_config2["default"].globalNodeModules,r.name)],t=r.bin;"string"==typeof t&&(t={},t[r.name]=r.bin),t=t||{};var o=(0,_keys2["default"])(t).map(function(e){return[_path2["default"].join(_config2["default"].globalNodeModules,r.name,t[e]),_path2["default"].join(_config2["default"].globalBin,e)]});return o.concat([n])}function unlinkFromGlobal(e,r){var n=_path2["default"].join(e,"node_modules",r);return console.log("rm",n),_fsPromise2["default"].unlink(n)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.unlinkToGlobal=exports.linkFromGlobal=exports.linkToGlobal=void 0;var _regenerator=require("babel-runtime/regenerator"),_regenerator2=_interopRequireDefault(_regenerator),_promise=require("babel-runtime/core-js/promise"),_promise2=_interopRequireDefault(_promise),_asyncToGenerator2=require("babel-runtime/helpers/asyncToGenerator"),_asyncToGenerator3=_interopRequireDefault(_asyncToGenerator2),_keys=require("babel-runtime/core-js/object/keys"),_keys2=_interopRequireDefault(_keys),linkToGlobal=exports.linkToGlobal=function(){var e=(0,_asyncToGenerator3["default"])(_regenerator2["default"].mark(function r(e){var n,t,o=this;return _regenerator2["default"].wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return n=require(_path2["default"].join(e,"package.json")),t=getSymlinks(e,n),r.abrupt("return",_promise2["default"].all(t.map(function(){var e=(0,_asyncToGenerator3["default"])(_regenerator2["default"].mark(function r(e){var n,t;return _regenerator2["default"].wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return n=e[0],t=e[1],console.log(t,"->",n),r.next=5,(0,_forceSymlink2["default"])(n,t,_config2["default"].symlinkType);case 5:case"end":return r.stop()}},r,o)}));return function(r){return e.apply(this,arguments)}}())));case 3:case"end":return r.stop()}},r,this)}));return function(r){return e.apply(this,arguments)}}(),linkFromGlobal=exports.linkFromGlobal=function(){var e=(0,_asyncToGenerator3["default"])(_regenerator2["default"].mark(function r(e,n){var t,o;return _regenerator2["default"].wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return t=_path2["default"].join(e,"node_modules",n),o=_path2["default"].join(_config2["default"].globalNodeModules,n),console.log(t,"->",o),r.next=5,(0,_forceSymlink2["default"])(o,t,_config2["default"].symlinkType);case 5:case"end":return r.stop()}},r,this)}));return function(r,n){return e.apply(this,arguments)}}(),unlinkToGlobal=exports.unlinkToGlobal=function(){var e=(0,_asyncToGenerator3["default"])(_regenerator2["default"].mark(function r(e,n){var t,o,a=this;return _regenerator2["default"].wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return t=require(_path2["default"].join(e,"package.json")),o=getSymlinks(e,t),r.abrupt("return",_promise2["default"].all(o.map(function(){var e=(0,_asyncToGenerator3["default"])(_regenerator2["default"].mark(function r(e){var n;return _regenerator2["default"].wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return n=e[1],console.log("rm",n),r.next=4,_fsPromise2["default"].unlink(n);case 4:case"end":return r.stop()}},r,a)}));return function(r){return e.apply(this,arguments)}}())));case 3:case"end":return r.stop()}},r,this)}));return function(r,n){return e.apply(this,arguments)}}();exports.getSymlinks=getSymlinks,exports.unlinkFromGlobal=unlinkFromGlobal;var _fsPromise=require("fs-promise"),_fsPromise2=_interopRequireDefault(_fsPromise),_path=require("path"),_path2=_interopRequireDefault(_path),_config=require("./config"),_config2=_interopRequireDefault(_config),_forceSymlink=require("./force-symlink"),_forceSymlink2=_interopRequireDefault(_forceSymlink);